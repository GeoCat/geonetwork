<div class="mt-4">
  <strong>Debug â€” aggregations:</strong>
  <pre style="max-height:200px; overflow:auto">{{ aggregations | json }}</pre>

  <strong>Selected filters:</strong>
  <pre>{{ selectedFilters | json }}</pre>
</div>

<p-accordion [multiple]="true">
  @for (key of aggregationKeys(); track $index) {
    <p-accordion-panel [value]="$index">
      <p-accordion-header>{{key | translate}}</p-accordion-header>
      <p-accordion-content>
        @for (bucket of getBuckets(aggregations[key]); track $index) {
          <div class="flex items-center">
            <p-checkbox
              [binary]="true"
              [inputId]="key + '_' + bucket.key"
              [ngModel]="getSelected(key, bucket.key)"
              (ngModelChange)="setSelected(key, bucket.key, $event)"
            ></p-checkbox>
            <label [for]="key + '_' + bucket.key">{{bucket.key | translate}} ({{bucket.doc_count}})</label>
          </div>
        }
      </p-accordion-content>
    </p-accordion-panel>
  }
</p-accordion>
