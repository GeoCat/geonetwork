<div class="container mx-auto p-4">
  <div class="mb-4">
    <button
      pButton
      (click)="goBack()"
      [outlined]="true"
    >
      <ng-icon name="faSolidArrowLeft" pButtonIcon></ng-icon>
      <span pButtonLabel>Back to Results</span>
    </button>
  </div>

  @if (isLoading()) {
    <app-loading-component/>
  }

  @if (result() && !isLoading()) {
    <p-card>
      <ng-template pTemplate="header">
        <div class="p-4 bg-surface-50">
          <h1 class="text-2xl font-bold">
            {{ result()?.resourceTitleObject?.['default'] }}
          </h1>
          <h2 class="text-xl">{{ result()?.resourceType }}</h2>
          <p class="text-surface-600 mt-2">ID: {{ result()?.uuid }}</p>
        </div>
      </ng-template>
      <div class="p-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="md:col-span-1">
            <div class="bg-surface-100 rounded p-8 text-center">
              @if (getOverviewImage()) {
                <img
                  [src]="getOverviewImage()"
                  [alt]="getOverviewImageName()"
                  class="w-full h-auto rounded shadow-md"
                  (error)="$event.target.style.display = 'none'"
                />
              } @else {
                <ng-icon name="faImage" class="text-6xl text-surface-400"></ng-icon>
                <p class="mt-2 text-sm text-surface-600">No preview available</p>
              }
            </div>
          </div>
          <div class="md:col-span-2">
            <h3 class="text-xl font-semibold mb-3">Description</h3>
            <p class="text-surface-700 leading-relaxed mb-6">
              {{ result()?.resourceAbstractObject?.['default'] || 'No description available' }}
            </p>
            <div class="flex gap-3">
              <button
                pButton
                class="flex-auto md:flex-initial"
              >
                <ng-icon name="faSolidDownload" pButtonIcon></ng-icon>
                <span pButtonLabel>Download</span>
              </button>
              <button pButton [outlined]="true">
                <ng-icon name="faSolidShareNodes" pButtonIcon></ng-icon>
                <span pButtonLabel>Share</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </p-card>
    <!-- if resourcetype is metadata -->
    <div>
      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Date(s)</h3>
        <p>{{ source.resourceTemporalExtentDetails?.[0]?.start?.date }} (Creation)</p>
        <p>{{ source.createDate }} (Publication)</p>
        <p>{{ source.resourceTemporalExtentDetails?.[0]?.start?.date }} (Temporal coverage)</p>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Authors</h3>
        <ul>
          <li *ngFor="let author of getAuthors()">
            <span>{{ author.individual }}</span>
            <span> ({{ getOrgName() }}) </span>
            <span *ngIf="author.email">
              - <a href="mailto:{{ author.email }}">{{ author.email }}</a></span
            >
          </li>
        </ul>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Contacts</h3>
        <ul>
          <li *ngFor="let contact of getContacts()">
            <span>{{ contact.individual }}</span>
            <span> ({{ getOrgName() }}) </span>
            <span *ngIf="contact.email">
              - <a href="mailto:{{ contact.email }}">{{ contact.email }}</a></span
            >
          </li>
        </ul>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Source</h3>
        <p>{{ getOrgName() }}</p>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Lineage</h3>
        <p>{{ getLineage() }}</p>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Constraints</h3>
        <p>
          Use limitation:
          <a [href]="getConstraints().link" target="_blank" class="font-bold">
            {{ getConstraints().default }}
          </a>
        </p>
        <p>
          Use constraints:
          <a [href]="getUseConstraint().link" target="_blank">
            {{ getUseConstraint().default }}
          </a>
        </p>
        <p>
          Other constraints:
          <a [href]="getOtherConstraint().link" target="_blank">
            {{ getOtherConstraint().default }}
          </a>
        </p>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Spatial informations</h3>
        <p>
          <span>Data type: {{ source.cl_spatialRepresentationType?.[0]?.key }}</span>
        </p>
        <p>
          <span>Resolution: {{ source.resolutionDistance?.[0] }}</span>
        </p>
        <p>
          <span>Coordinate system: {{ source.coordinateSystem?.[0] }}</span>
        </p>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h3 class="text-xl">Related resources</h3>

        <div class="my-6 border p-3 border-gray-300">
          <h5 class="text-lg font-semibold">Children</h5>
          <ul>
            <li></li>
          </ul>
        </div>

        <div class="my-6 border p-3 border-gray-300">
          <h5 class="text-lg font-semibold">Associated resources</h5>
          <ul>
            <li></li>
          </ul>
        </div>
      </div>
    </div>
  }

  @if (!result() && !isLoading()) {
    <div class="text-center p-8">
      <ng-icon name="faSolidCircleExclamation" class="text-4xl text-orange-500"/>
      <h2 class="text-xl font-semibold mt-3">Record Not Found</h2>
      <p class="text-surface-600 mt-2">The requested catalogue item could not be found.</p>
    </div>
  }
</div>
