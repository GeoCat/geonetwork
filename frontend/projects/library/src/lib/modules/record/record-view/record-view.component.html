<ng-template #defaultBackButton></ng-template>

@if (recordStatus(); as status) {
  <p>{{ status }}</p>
}
@if (record(); as record) {
  <ng-container *ngTemplateOutlet="backButtonTplRef() || defaultBackButton"></ng-container>

  <p-card>
    <ng-template pTemplate="header">
      <div class="p-4 bg-surface-50">
        <h1 class="text-2xl font-bold">
          {{ record.resourceTitleObject?.['default'] }}
        </h1>
        <h2 class="text-xl">{{ record.resourceType }}</h2>
        <p class="text-surface-600 mt-2">ID: {{ record.uuid }}</p>
      </div>
    </ng-template>
    <div class="p-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="md:col-span-1">
          <div class="bg-surface-100 rounded p-8 text-center">
            @if (getOverviewImage()) {
              <img
                [src]="getOverviewImage()"
                [alt]="getOverviewImageName()"
                class="w-full h-auto rounded shadow-md"
                (error)="$event.target.style.display = 'none'"
              />
            } @else {
              <ng-icon name="faImage" class="text-6xl text-surface-400"></ng-icon>
              <p class="mt-2 text-sm text-surface-600">No preview available</p>
            }
          </div>
        </div>
        <div class="md:col-span-2">
          <h3 class="text-xl font-semibold mb-3">Description</h3>
          <p class="text-surface-700 leading-relaxed mb-6">
            {{ record.resourceAbstractObject?.['default'] || 'No description available' }}
          </p>
          <div class="flex gap-3">
            <button pButton class="flex-auto md:flex-initial">
              <ng-icon name="faSolidDownload" pButtonIcon></ng-icon>
              <span pButtonLabel>Download</span>
            </button>
            <button pButton [outlined]="true">
              <ng-icon name="faSolidShareNodes" pButtonIcon></ng-icon>
              <span pButtonLabel>Share</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </p-card>

  <!-- if resourcetype is metadata -->
  <div>
    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Date(s)</h3>
      <p>{{ record.resourceTemporalExtentDetails?.[0]?.start?.date }} (Creation)</p>
      <p>{{ record.createDate }} (Publication)</p>
      <p>{{ record.resourceTemporalExtentDetails?.[0]?.start?.date }} (Temporal coverage)</p>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Authors</h3>
      <ul>
        @for (author of getAuthors(); track $index) {
          <li>
            <span>{{ author.individual }}</span>
            <span> ({{ getOrgName() }}) </span>
            @if (author.email) {
              - <a href="mailto:{{ author.email }}">{{ author.email }}</a>
            }
          </li>
        }
      </ul>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Contacts</h3>
      <ul>
        @for (contact of getContacts(); track $index) {
          <li>
            <span>{{ contact.individual }}</span>
            <span> ({{ getOrgName() }}) </span>
            @if (contact.email) {
              - <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
            }
          </li>
        }
      </ul>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Source</h3>
      <p>{{ getOrgName() }}</p>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Lineage</h3>
      <p>{{ getLineage() }}</p>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Constraints</h3>
      <p>
        Use limitation:
        <a [href]="getConstraints().link" target="_blank" class="font-bold">
          {{ getConstraints().default }}
        </a>
      </p>
      <p>
        Use constraints:
        <a [href]="getUseConstraint().link" target="_blank">
          {{ getUseConstraint().default }}
        </a>
      </p>
      <p>
        Other constraints:
        <a [href]="getOtherConstraint().link" target="_blank">
          {{ getOtherConstraint().default }}
        </a>
      </p>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Spatial informations</h3>
      <p>
        <span>Data type: {{ record['cl_spatialRepresentationType']?.[0]?.key }}</span>
      </p>
      <p>
        <span>Resolution: {{ record.resolutionDistance?.[0] }}</span>
      </p>
      <p>
        <span>Coordinate system: {{ record.coordinateSystem?.[0] }}</span>
      </p>
    </div>

    <div class="my-6 border p-3 border-gray-300">
      <h3 class="text-xl">Related resources</h3>

      <div class="my-6 border p-3 border-gray-300">
        <h5 class="text-lg font-semibold">Children</h5>
        <ul>
          <li></li>
        </ul>
      </div>

      <div class="my-6 border p-3 border-gray-300">
        <h5 class="text-lg font-semibold">Associated resources</h5>
        <ul>
          <li></li>
        </ul>
      </div>
    </div>
  </div>
}
